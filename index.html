<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="style.css">

	<script src="http://MermaidJS/_archive_/v8.9.1/from-GitHub/mermaid-develop/dist/mermaid.js"></script>


	<script type="text/javascript" src="https://pagecdn.io/lib/ace/1.4.12/ace.js"></script>
	<script type="text/javascript" src="https://pagecdn.io/lib/ace/1.4.12/ext-language_tools.js"></script>
	<script type="text/javascript" src="https://pagecdn.io/lib/ace/1.4.12/ext-emmet.js"></script>

	<script type="text/javascript" src="./Ace-Emmet/emmet.js"></script>

	<script type="text/javascript" src="./Ace_PlugKit/plug-ace.js"></script>
	<link rel="stylesheet" href="./Ace_PlugKit/plug-ace.css">


	<script>mermaid.initialize({startOnLoad:true});</script>

	<title>JS promise help</title>
</head>
<body>
	<h1>JS promise help</h1>
	<ol>
		<li>
			<h2>An empty promise</h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "Promise.resolve ( ... )"
						no_hand["#32; empty "]
					end

					class e_hand,e_hand_2 err-block
					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					var pA = Promise.resolve();
					var pB = Promise.resolve("value");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "Promise.reject ( ... )"
						no_hand["#32; empty "]
					end

					class e_hand,e_hand_2 err-block
					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					var pA = Promise.reject();
					var pB = Promise.reject(new Error());
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A promise with executor</h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end
					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]

					class e_hand,e_hand_2 err-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					var pA = new Promise ((rs, rj) => {
						console.log("executor - sync");
				
						setTimeout(() => {
							console.log("executor - async");
							rs();
						}, 200);
					});
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A promise with status handlers</h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph ".then ( ... )"
						s_hand
						e_hand
					end
					s_hand["success <br> handler"]
					e_hand["error <br> handler"]

					class e_hand,e_hand_2 err-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					var pB = pA.then (
						(v) => {
							console.log(v);
							return v;
						},
						(e) => {
							console.error("-catched-", e);
							return e;
						}
					);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A chain with two promises</h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end
					subgraph ".then ( ... )"
						s_hand
						e_hand
					end
					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|e_hand["error <br> handler"]
					ex_sync-.->|"err"|e_hand["error <br> handler"]

					class e_hand,e_hand_2 err-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor");
						setTimeout(rs, 200);
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A promises with one handler</h2>
			
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end
					subgraph ".then ( ... )"
						s_hand
						no_hand
					end
					subgraph ".catch ( ... )"
						no_hand_2
						e_hand_2
					end
					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|no_hand["empty"]
					ex_sync-.->|"err"|no_hand
					s_hand==>no_hand_2["empty"]
					s_hand-.->|"err"|e_hand_2["error <br> handler 2"]
					no_hand-->e_hand_2

					class e_hand,e_hand_2 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						setTimeout(rs, 200);
						throw new Error();
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							}
						).
						catch (
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
				
					console.log("end of tread");
				</div>
			</details>
		</li>
		<li>
			<h2>Using <code>.then(null, ...)</code> instead <code>.catch(...)</code></h2>
			
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end
					subgraph ".then ( ... )"
						s_hand
						no_hand
					end
					subgraph ".then (null, ... )"
						no_hand_2
						e_hand_2
					end
					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|no_hand["empty"]
					ex_sync-.->|"err"|no_hand
					s_hand==>no_hand_2["empty"]
					s_hand-.->|"err"|e_hand_2["error <br> handler 2"]
					no_hand-->e_hand_2

					class e_hand,e_hand_2 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						setTimeout(rs, 200);
						throw new Error();
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							}
						).
						then (       // .then(null, ...) instead .catch(...)
							null,
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
				
					console.log("end of tread");
				</div>
			</details>
		</li>
		<li>
			<h2>A long chain</h2>
			
			<div class="mermaid" id="pr_scheme">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end

					subgraph ".then ( ... )"
						s_hand
						e_hand
					end

					subgraph ".then ( ... )"
						s_hand_2
						e_hand_2
					end

					subgraph ".then ( ... )"
						s_hand_3
						e_hand_3
					end

					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|e_hand["error <br> handler"]
					s_hand_2-.->|"err"|e_hand_3["error <br> handler 3"]
					s_hand-.->|"err"|e_hand_2["error <br> handler 2"]
					s_hand==>s_hand_2["success <br> handler 2"]
					s_hand_2==>s_hand_3["success <br> handler 3"]
					ex_sync-.->|"err"|e_hand["error <br> handler"]
					e_hand==>s_hand_2
					e_hand-.->|"err"|e_hand_2
					e_hand_2==>s_hand_3
					e_hand_2-.->|"err"|e_hand_3

					class e_hand,e_hand_2,e_hand_3,e_hand_4 err-block

					class no_hand,no_hand_2,no_hand_3,no_hand_4 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor");
						setTimeout(rs, 200);
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A long chain without one <code>onReject()</code> handler</h2>
			
			<div class="mermaid" id="pr_scheme">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end

					subgraph ".then ( ... )"
						s_hand
						e_hand
					end

					subgraph ".then ( ... )"
						s_hand_2
						no_hand_2
					end

					subgraph ".then ( ... )"
						s_hand_3
						e_hand_3
					end

					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|e_hand["error <br> handler"]
					s_hand_2-.->|"err"|e_hand_3["error <br> handler 3"]
					s_hand-.->|"err"|no_hand_2["empty"]
					s_hand==>s_hand_2["success <br> handler 2"]
					s_hand_2==>s_hand_3["success <br> handler 3"]
					ex_sync-.->|"err"|e_hand["error <br> handler"]
					e_hand==>s_hand_2
					e_hand-.->|"err"|no_hand_2
					no_hand_2-->e_hand_3

					class e_hand,e_hand_2,e_hand_3,e_hand_4 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor");
						setTimeout(rs, 200);
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>A long chain without one <code>onResolve()</code> handler</h2>
			
			<div class="mermaid" id="pr_scheme">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync
						ex_async
					end

					subgraph ".then ( ... )"
						s_hand
						e_hand
					end

					subgraph ".catch ( ... )"
						no_hand_2
						e_hand_2
					end

					subgraph ".then ( ... )"
						s_hand_3
						e_hand_3
					end

					ex_sync["sync"]-->|" ... t ... "|ex_async["async"]
					ex_async==>|"resolve()"|s_hand["success <br> handler"]
					ex_async-.->|"reject()"|e_hand["error <br> handler"]
					s_hand-.->|"err"|e_hand_2["error <br> handler 2"]
					s_hand==>no_hand_2["empty"]
					no_hand_2-->s_hand_3["success <br> handler 3"]
					ex_sync-.->|"err"|e_hand["error <br> handler"]
					e_hand==>no_hand_2
					e_hand-.->|"err"|e_hand_2
					e_hand_2==>s_hand_3
					e_hand_2-.->|"err"|e_hand_3["error <br> handler 3"]

					class e_hand,e_hand_2,e_hand_3,e_hand_4 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor");
						setTimeout(rs, 200);
					}).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						catch (
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>Inserting a promise to the chain</h2>
			
			<div class="mermaid" id="pr_scheme">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync["sync"]
						ex_async["async"]
					end

					subgraph ".then ( ... )"
						s_hand["success <br> handler"]
						e_hand["error <br> handler"]
					end

					subgraph "return new Promise ( ... )"
						ex_sync_2["sync"]
						ex_async_2["async"]
					end

					subgraph ".then ( ... )"
						s_hand_3["success <br> handler 3"]
						e_hand_3["error <br> handler 3"]
					end

					ex_sync-->|" ... t ... "|ex_async
					ex_async==>|"resolve()"|s_hand
					ex_async-.->|"reject()"|e_hand
					s_hand==>ex_sync_2
					ex_sync_2-->|" ... t ... "|ex_async_2
					ex_sync-.->|"err"|e_hand
					e_hand==>s_hand_3
					ex_async_2==>|"resolve()"|s_hand_3
					ex_async_2-.->|"reject()"|e_hand_3
					ex_sync_2-.->|"err"|e_hand_3
					e_hand-.->|"err"|e_hand_3

					class e_hand,e_hand_2,e_hand_3,e_hand_4 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor - sync");
						setTimeout(rs, 200);
					}).
						then (
							(v) => {
								console.log(v);
								return new Promise ((rs, rj) => {
									console.log("executor-2 - sync");
									setTimeout(rs, 200);
								});
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2>Inserting a promise chain to the chain</h2>
			
			<div class="mermaid" id="pr_scheme">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync["sync"]
						ex_async["async"]
					end

					subgraph ".then ( ... )"
						s_hand["success <br> handler"]
						e_hand["error <br> handler"]
					end

					subgraph "return new Promise ( ... )"
						ex_sync_2["sync"]
						ex_async_2["async"]
					end

					subgraph ".then ( ... )"
						s_hand_2["success <br> handler 2"]
						e_hand_2["error <br> handler 2"]
					end

					subgraph ".then ( ... )"
						s_hand_3["success <br> handler 3"]
						e_hand_3["error <br> handler 3"]
					end

					ex_sync-->|" ... t ... "|ex_async
					ex_async==>|"resolve()"|s_hand
					ex_async-.->|"reject()"|e_hand
					s_hand==>ex_sync_2
					ex_sync_2-->|" ... t ... "|ex_async_2
					ex_sync-.->|"err"|e_hand
					e_hand==>s_hand_3
					ex_async_2==>|"resolve()"|s_hand_2
					ex_async_2-.->|"reject()"|e_hand_2
					ex_sync_2-.->|"err"|e_hand_2
					s_hand_2==>s_hand_3
					e_hand_2-.->|"err"|e_hand_3
					e_hand-.->|"err"|e_hand_3

					class e_hand,e_hand_2,e_hand_3,e_hand_4 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor - sync");
						setTimeout(rs, 200);
						throw new Error();
					}).
						then (
							(v) => {
								console.log(v);
								return new Promise ((rs, rj) => {
									console.log("executor-2 - sync");
									setTimeout(rs, 200);
								}).then(
									(v) => {
										console.log(v);
										return v;
									},
									(e) => {
										console.error("-catched-", e);
										return e;
									}
								);
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						).
						then (
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2><code>.finally(...)</code></h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync["sync"]
						ex_async["async"]
					end
					subgraph ".finally ( ... )"
						fin_hand["all <br> status <br> handler"]
					end
					ex_sync-->|" ... t ... "|ex_async
					ex_async==>|"resolve()"|fin_hand
					ex_async-.->|"reject()"|fin_hand
					ex_sync-.->|"err"|fin_hand

					class e_hand,e_hand_2 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

					class fin_hand fin-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor - sync");

						setTimeout(() => {
							console.log("executor - async");
							rs();
						}, 200);
					}).
						finally(
							() => {
								console.log("-finaly-");
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
		<li>
			<h2><code>.finally(...).then(...)</code></h2>
			<div class="mermaid" id="pr_scheme" style="text-align: left;">
				graph LR
					subgraph "new Promise ( ... )"
						ex_sync["sync"]
						ex_async["async"]
					end

					subgraph ".finally ( ... )"
						fin_hand["all <br> status <br> handler"]
					end
					subgraph ".then ( ... )"
						s_hand["success <br> handler"]
						e_hand["error <br> handler"]
					end

					ex_sync-->|" ... t ... "|ex_async
					ex_async==>|"resolve()"|fin_hand
					ex_async-.->|"reject()"|fin_hand
					ex_sync-.->|"err"|fin_hand
					fin_hand==>s_hand
					fin_hand-.->e_hand

					class e_hand,e_hand_2 err-block

					class no_hand,no_hand_2,no_hand_3 empty-block

					class fin_hand fin-block

			</div>
			<details>
				<summary>code</summary>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
				<div class="ace-plug-js">
					new Promise ((rs, rj) => {
						console.log("executor - sync");

						setTimeout(() => {
							console.log("executor - async");
							rs();
						}, 200);
					}).
						finally(
							() => {
								console.log("-finaly-");
							}
						).
						then(
							(v) => {
								console.log(v);
								return v;
							},
							(e) => {
								console.error("-catched-", e);
								return e;
							}
						);
					console.log("end of tread");
				</div>
				<!-- <? d_l_n(__LINE__, __FILE__); ?><br> -->
			</details>
		</li>
	</ol>

	<script type="text/javascript">
		!function() {
			document.querySelectorAll(".ace-plug-js").forEach((v) => {
				PlugAce.retabulate(v);
				PlugAce.plug(v, 
					{
						maxLines: 30,
						syntax: "javascript", 
						syntaxMark: "js",
					});
			});
			document.querySelectorAll(".ace-plug-html").forEach((v) => {
				PlugAce.retabulate(v);
				PlugAce.plug(v, 
					{
						maxLines: 30,
						syntax: "html", 
					});
			});
		}();
	</script>
</body>
</html>